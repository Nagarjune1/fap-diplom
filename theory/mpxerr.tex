\gdef\mpxshipout{\shipout\hbox\bgroup%
  \setbox0=\hbox\bgroup}%
\gdef\stopmpxshipout{\egroup  \dimen0=\ht0 \advance\dimen0\dp0
  \dimen1=\ht0 \dimen2=\dp0
  \setbox0=\hbox\bgroup
    \box0
    \ifnum\dimen0>0 \vrule width1sp height\dimen1 depth\dimen2 
    \else \vrule width1sp height1sp depth0sp\relax
    \fi\egroup
  \ht0=0pt \dp0=0pt \box0 \egroup}
\mpxshipout% line 9 ./trees.mp
$M$%
\stopmpxshipout
\mpxshipout% line 10 ./trees.mp
$M$%
\stopmpxshipout
\mpxshipout% line 11 ./trees.mp
$S$%
\stopmpxshipout
\mpxshipout% line 12 ./trees.mp
$y$%
\stopmpxshipout
\mpxshipout% line 13 ./trees.mp
$x$%
\stopmpxshipout
\mpxshipout% line 14 ./trees.mp
$x$%
\stopmpxshipout
\mpxshipout% line 25 ./trees.mp
$S$%
\stopmpxshipout
\mpxshipout% line 26 ./trees.mp
$x$%
\stopmpxshipout
\mpxshipout% line 35 ./trees.mp
$M$%
\stopmpxshipout
\mpxshipout% line 36 ./trees.mp
$x$%
\stopmpxshipout
\mpxshipout% line 37 ./trees.mp
$x$%
\stopmpxshipout
\mpxshipout% line 46 ./trees.mp
$M$%
\stopmpxshipout
\mpxshipout% line 47 ./trees.mp
$x$%
\stopmpxshipout
\mpxshipout% line 48 ./trees.mp
$x$%
\stopmpxshipout
\end{document}
